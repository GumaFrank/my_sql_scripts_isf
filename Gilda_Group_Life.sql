/*
AUTHOR Eng Frank Bagambe
Descrption, Requested by Gilda Katusiime
*/
SELECT 
POLICY_NO,
DECODE(POLICY_NO, 'UG202100703884', 'HOUSING FINANCE BANK-MP CREDIT LIFE',
'UG202200912476', 'HOUSING FINANCE BANK- MP LOANS',
'UG202200819295', 'HOUSING FINANCE BANK SWIFT LOANS 2022',
'UG202200825923', 'HOUSING FINANCE BANK SWIFT LOANS USD 2022',
'UG201900488355', 'HFB - NSSF STAFF MORTGAGES (NEW)') AS COMPANY_NAME,
--(SELECT V_COMPANY_CODE FROM GNMT_POLICY_DETAIL WHERE V_POLICY_NO =POLICY_NO)
N_SALARY,
START_DATE,
N_CUST_REF_NO,
V_NAME,
D_BIRTH_DATE,
(SELECT V_STATUS_DESC FROM GNMM_POLICY_STATUS_MASTER WHERE V_STATUS_CODE=STAT_CODE) CUSTOMER_STATUS
FROM 
(
SELECT 
DISTINCT A.V_POLICY_NO POLICY_NO,
A.N_SALARY,
A.D_CNTR_START_DATE START_DATE,
A.N_CUST_REF_NO,
B.V_NAME, 
B.D_BIRTH_DATE,
A.V_CNTR_STAT_CODE AS STAT_CODE
--N_CUST_REF_NO
FROM
GNMT_POLICY_DETAIL A, GNMT_CUSTOMER_MASTER B
WHERE 
A.N_CUST_REF_NO=B.N_CUST_REF_NO
AND   A.V_POLICY_NO IN 
('UG201900488355',
'UG202200819295',
'UG202200825923',
'UG202200912476',
'UG202100703884')
)
ORDER BY 4 DESC